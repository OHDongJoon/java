DROP TABLE MEMBER_TBL_02 ;
CREATE TABLE MEMBER_TBL_02(
 CUSTNO NUMBER(6) PRIMARY KEY,
 CUSTNAME VARCHAR2(60),
 PHONE VARCHAR2(13),
 ADDRESS VARCHAR2(60),
 JOINDATE DATE,
 GRADE CHAR(1),
 CITY CHAR(2)
);
DROP SEQUENCE MEMBER_SEQ;
CREATE SEQUENCE MEMBER_SEQ START WITH 100001 MAXVALUE 999999 NOCACHE NOCYCLE;
INSERT INTO MEMBER_TBL_02
	VALUES (MEMBER_SEQ.NEXTVAL , '김행복' , '010-1111-2222','서울 동대문구 휘경1동',TO_DATE('20151202','YYYYMMDD'), 'A', '01');
INSERT INTO MEMBER_TBL_02
	VALUES (MEMBER_SEQ.NEXTVAL , '이축복' , '010-1111-3333','서울 동대문구 휘경2동',TO_DATE('20151206','YYYYMMDD'), 'B', '01');
INSERT INTO MEMBER_TBL_02
	VALUES (MEMBER_SEQ.NEXTVAL , '장믿음' , '010-1111-4444','울릉군 울릉읍 독도1리',TO_DATE('20151001','YYYYMMDD'), 'B', '30');
INSERT INTO MEMBER_TBL_02
	VALUES (MEMBER_SEQ.NEXTVAL , '최사람' , '010-1111-5555','울룽군 울릉읍 독도2리',TO_DATE('20151113','YYYYMMDD'), 'A', '30');
INSERT INTO MEMBER_TBL_02
	VALUES (MEMBER_SEQ.NEXTVAL , '진평화' , '010-1111-6666','제주도 제주시 외나무골',TO_DATE('20151225','YYYYMMDD'), 'B', '60');
INSERT INTO MEMBER_TBL_02
	VALUES (MEMBER_SEQ.NEXTVAL , '차공단' , '010-1111-7777','제주도 제주시 감나무골',TO_DATE('20151211','YYYYMMDD'), 'C', '60');
	
UPDATE MEMBER_TBL_02 SET CUSTNAME ='오동준',
						 PHONE ='010-9999-9999',
						 ADDRESS = '제주도',
						 JOINDATE = '19951010',
						 GRADE  = 'C',
						 CITY ='40'
						 WHERE CUSTNO = 100001;
						 
	SELECT * FROM MEMBER_TBL_02;
	

CREATE TABLE MONEY_TBL_02(
	CUSTNO NUMBER(6),
	SELENON NUMBER(8) PRIMARY KEY,
	PCOST NUMBER(8),
	AMOUNT NUMBER(4),
	PRICE NUMBER(8),
	PCODE VARCHAR2(4),
	SDATE DATE
);
INSERT INTO MONEY_TBL_02
	VALUES (1001,20160001,500,5,2500,'A001',TO_DATE('20160101','YYYYMMDD'));
	
INSERT INTO MONEY_TBL_02
	VALUES (1001,20160002,1000,4,4000,'A002',TO_DATE('20160101','YYYYMMDD'));
	
INSERT INTO MONEY_TBL_02
	VALUES (1001,20160003,500,3,1500,'A008',TO_DATE('20160101','YYYYMMDD'));
	
INSERT INTO MONEY_TBL_02
	VALUES (1002,20160004,2000,1,2000,'A004',TO_DATE('20160102','YYYYMMDD'));
	
INSERT INTO MONEY_TBL_02
	VALUES (1002,20160005,500,1,500,'A001',TO_DATE('20160103','YYYYMMDD'));
	
INSERT INTO MONEY_TBL_02
	VALUES (1003,20160006,1500,2,3000,'A003',TO_DATE('20160103','YYYYMMDD'));
	
INSERT INTO MONEY_TBL_02
	VALUES (1004,20160007,500,2,1000,'A001',TO_DATE('20160104','YYYYMMDD'));
	
INSERT INTO MONEY_TBL_02
	VALUES (1004,20160008,300,1,300,'A005',TO_DATE('20160104','YYYYMMDD'));
	
INSERT INTO MONEY_TBL_02
	VALUES (1004,20160009,600,1,600,'A006',TO_DATE('20160104','YYYYMMDD'));
	
INSERT INTO MONEY_TBL_02
	VALUES (1004,20160010,3000,1,3000,'A007',TO_DATE('20160106','YYYYMMDD'));
SELECT * FROM MONEY_TBL_02;
	

	
	
SELECT * FROM MONEY_TBL_02;
/*회원매출 조회*/
SELECT CUSTNO, SUM(PRICE) SUM FROM MONEY_TBL_02 GROUP BY CUSTNO;

SELECT member.CUSTNO, CUSTNAME, GRADE, PRICE
  FROM MEMBER_TBL_02 member, MEMBERLEVEL m1,
    (SELECT CUSTNO, SUM(PRICE) PRICE FROM MONEY_TBL_02 GROUP BY CUSTNO) m1
   WHERE member.CUSTNO = sales.CUSTNO AND m1.GRADE = member.GRADE
   ORDER BY PRICE DECS;
   
SELECT member.CUSTNO, member.CUSTNAME, ml.GRADE, ml.PRICE
   from MEMBER_TBL_02 member, MENEY_TBL_02 ml,
      (SELECT CUSTNO, SUM(PRICE) price FROM MENEY_TBL_02 group BY CUSTNO) ml
   where member.custno = ml.custno and ml.grade=member.grade
   order by price desc;

